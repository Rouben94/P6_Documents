\clearpage

\section{Schluss}\label{sec:Schluss}


\subsection{Zielerreichung}\label{subsec:Zielerreichung}
Für die vorliegende Projektarbeit wurden im Pflichtenheft (siehe Anhang \ref{app:Pflichtenheft}) klare Ziele definiert.
In den Tabellen \ref{tab:ErreichungP2PZiele}, \ref{tab:ErreichungMeshZiele}, \ref{tab:ErreichungSteuersoftwareZiele} und \ref{tab:ErreichungZusatzziele} sind diese in kurzer Form nochmals zusammengefasst. Ausserdem ist ersichtlich, welche Ziele erfüllt und welche nicht bzw. nur bedingt erfüllt werden konnten.
Falls nötig ist auch noch ein kurzer Kommentar hinterlegt.

\paragraph{Punkt zu Punkt Testinfrastruktur}
\begin{table}[H]
	\centering
	\begin{tabular}{|c|l|c|l|} 
		\hline
		\multicolumn{4}{|l|}{\textbf{Projektziele Punkt zu Punkt Testinfrastruktur}}                                                                                                                                                                                                                                                                                                      \\ 
		\hline
		\textbf{Nr.}              & \textbf{Ziel}                                                                                      & \textbf{Erfüllt} & \textbf{Kommentar}                                                                                                                                                                           \\ 
		\hline
		P1                        & Kommunikation mit BMS                                                                              & Ja               & \begin{tabular}[c]{@{}l@{}}Alle Master Module werden via USB UART \\angesteuert.\end{tabular}                                                                                                \\ 
		\hline
		P2                        & Senden von MAC Frames                                                                              & Ja               &                                                                                                                                                                                              \\ 
		\hline
		P3                        & \begin{tabular}[c]{@{}l@{}}Rückbestätigung der \\MAC-Frames\end{tabular}                           & Ja               &                                                                                                                                                                                              \\ 
		\hline
		P4                        & \begin{tabular}[c]{@{}l@{}}Konfiguration der \\Anzahl BSN\end{tabular}                             & Bedingt          & \begin{tabular}[c]{@{}l@{}}Alle Slave-Nodes werden automatisch erkannt \\und angezeigt.\end{tabular}                                                                                         \\ 
		\hline
		P5                        & Adressierung der BSN                                                                               & Bedingt          & \begin{tabular}[c]{@{}l@{}}Alle Slave-Nodes werden automatisch erkannt \\und angezeigt.\end{tabular}                                                                                         \\ 
		\hline
		P6                        & Konfiguration der Kanäle                                                                           & Ja               & Kann über den Webserver angepasst werden.                                                                                                                                                    \\ 
		\hline
		P7                        & Einstellbare Framelänge                                                                            & Ja               & \begin{tabular}[c]{@{}l@{}}Die Payload kann über den Webserver \\eingestellt werden.\end{tabular}                                                                                            \\ 
		\hline
		P8                        & \begin{tabular}[c]{@{}l@{}}Einstellbare Frame und \\Kanalwechselrate\end{tabular}                  & Nein             &                                                                                                                                                                                              \\ 
		\hline
		P9                        & Einstellbare Sendeleistung                                                                         & Ja               & Kann über den Webserver angepasst werden.                                                                                                                                                    \\ 
		\hline
		\multicolumn{1}{|l|}{P10} & \begin{tabular}[c]{@{}l@{}}Anpassung der \\Modulationsart\end{tabular}                             & Ja               & Kann über den Webserver angepasst werden.                                                                                                                                                    \\ 
		\hline
		\multicolumn{1}{|l|}{P11} & \begin{tabular}[c]{@{}l@{}}Ein- und Ausschalten der \\Collision Avoidance \\(CSMA/CA)\end{tabular} & Ja               & \begin{tabular}[c]{@{}l@{}}Kann über den Webserver ein- und \\ausgeschaltet werden.\end{tabular}                                                                                             \\ 
		\hline
		\multicolumn{1}{|l|}{P12} & \begin{tabular}[c]{@{}l@{}}Erfassen der \\Verbindungsqualität\end{tabular}                         & Ja               & \begin{tabular}[c]{@{}l@{}}Der Master sendet und empfängt in einem \\Zeitintervall Frames von den Slave-Nodes \\und sendet die Daten an die \\Serielle-Schnittstelle weiter.~\end{tabular}  \\ 
		\hline
		\multicolumn{1}{|l|}{P13} & Tool für Feldtests                                                                                 & Ja               & \begin{tabular}[c]{@{}l@{}}Das Tool ist mit dem Webserver und der \\Firmware einsatzbereit.\end{tabular}                                                                                     \\
		\hline
	\end{tabular}
	\caption{Erreichung der Ziele der Punkt zu Punkt Testinfrastruktur}
	\label{tab:ErreichungP2PZiele}
\end{table}

\newpage
\paragraph{Performancevergleich Mesh Netzwerke}
\begin{table}[H]
	\centering
	\begin{tabular}{|c|l|c|l|} 
		\hline
		\multicolumn{4}{|l|}{ \textbf{Projektziele Performancevergleich Mesh Netzwerke} }                                                                                                                                                                                                                                                                   \\ 
		\hline
		\textbf{Nr.}  & \textbf{Ziel}                                                               & \textbf{Erfüllt}  & \textbf{Kommentar}                                                                                                                                                                            \\ 
		\hline
		P1            & Kommunikation mit BMS                                                       & Ja                & \begin{tabular}[c]{@{}l@{}}Alle Master Module werden via USB UART \\angesteuert.\end{tabular}                                                                                                 \\ 
		\hline
		P2            & Konfiguration BSN                                                           & Nein              & \begin{tabular}[c]{@{}l@{}}Alle Nodes im Netzwerk fungieren als \\Routing-Knoten.\end{tabular}                                                                                                \\ 
		\hline
		P3            & Mesh-Netzwerk                                                               & Ja                & \begin{tabular}[c]{@{}l@{}}Alle Netzwerke wurden in einem 50 Node \\Mesh-Netzwerk getestet.\end{tabular}                                                                                      \\ 
		\hline
		P4            & Simulation Sensorwerte                                                      & Ja                & \begin{tabular}[c]{@{}l@{}}Über ein Python Programm können \\Testzeit und Anzahl Nachrichten konfiguriert \\werden. Es können sogar verschiedene \\Zufalls-Modi gewählt werden.\end{tabular}  \\ 
		\hline
		P5            & Sensordaten                                                                 & Ja                & \begin{tabular}[c]{@{}l@{}}Die Sensordaten werden im RAM und \\FLASH des SoCs gespeichert und nach \\der Messung an den Master gesendet.\end{tabular}                                         \\ 
		\hline
		P6            & Datenauswertung                                                             & Ja                & \begin{tabular}[c]{@{}l@{}}Die Daten der Messungen wurden mit \\Hilfe von Excel Tabellen ausgewertet.\end{tabular}                                                                           \\ 
		\hline
		P7            & Störimmunität                                                               & Ja                & \begin{tabular}[c]{@{}l@{}}Störmessungen mit der \\P2P-Testinfrastruktur wurden gemacht.\end{tabular}                                                                                         \\ 
		\hline
		P8            & \begin{tabular}[c]{@{}l@{}}Unterschiedliche Test \\Bedingungen\end{tabular} & Ja                & \begin{tabular}[c]{@{}l@{}}Es wurden die drei Bereiche \\Haus, Wohnung und Labor getestet.\end{tabular}                                                                                          \\ 
		\hline
		P9            & Test und Validierung                                                        & Ja                & \begin{tabular}[c]{@{}l@{}}Die Mesh Netzwerke wurden im \\Fachbericht vollumfänglich verglichen \\und ausgewertet.\end{tabular}                                                               \\
		\hline
	\end{tabular}
	\caption{Erreichung der Ziele zu den Test Mesh Netzwerken}
	\label{tab:ErreichungMeshZiele}
\end{table}

\paragraph{Steuer- und Auswertesoftware}
\begin{table}[H]
	\centering
	\begin{tabular}{|c|l|c|l|} 
		\hline
		\multicolumn{4}{|l|}{ \textbf{Projektziele Steuer- und Auswertesoftware} }                                                                                                                                                                                                                                                                                \\ 
		\hline
		\textbf{Nr.}  & \textbf{Ziel}                                                                & \textbf{Erfüllt}  & \textbf{Kommentar}                                                                                                                                                                                        \\ 
		\hline
		P1            & Ansteuerung Funkmodul                                                        & Ja                & \begin{tabular}[c]{@{}l@{}}Alle Master Module werden via USB UART \\angesteuert.\end{tabular}                                                                                                             \\ 
		\hline
		P2            & Visualisierung Parameter                                                     & Bedingt           & \begin{tabular}[c]{@{}l@{}}Für die P2P-Testinfrastruktur steht ein \\Webserver zur Verfügung. Die Daten des \\Mesh-Tests werden in einer Excel-Tabelle \\ausgewertet und visualisiert.\end{tabular}  \\ 
		\hline
		P3            & User Interface (UI)                                                          & Ja                & \begin{tabular}[c]{@{}l@{}}Ein Django Webserver stellt ein UI für die \\Verwaltung der P2P-Testinfrastruktur \\zur Verfügung.\end{tabular}                                                                \\ 
		\hline
		P4            & \begin{tabular}[c]{@{}l@{}}Konfiguration Mesh-\\Netzwerk\end{tabular}        & Ja                & \begin{tabular}[c]{@{}l@{}}Ein Python Programm konfiguriert die \\Mesh Nodes über den BMN.\end{tabular}                                                                                                   \\ 
		\hline
		P5            & \begin{tabular}[c]{@{}l@{}}Einheitliche \\Kommunikation von BMS\end{tabular} & Ja                & \begin{tabular}[c]{@{}l@{}}Ein Python Programm steuert die Mesh \\Nodes über den BMN.\end{tabular}                                                                                                        \\
		\hline
	\end{tabular}
	\caption{Erreichung der zur Steuer- und Auswertesoftware}
	\label{tab:ErreichungSteuersoftwareZiele}
\end{table}

\paragraph{Zusatzziele}
\begin{table}[H]
	\centering
	\begin{tabular}{|c|l|c|l|} 
		\hline
		\multicolumn{4}{|l|}{ \textbf{Projektziele Zusatz} }                                                                                                                                                                                                                  \\ 
		\hline
		\textbf{Nr.}  & \textbf{Ziel}                                                       & \textbf{Erfüllt}  & \textbf{Kommentar}                                                                                                                                   \\ 
		\hline
		P1            & \begin{tabular}[c]{@{}l@{}}Hardware Testmodul\\BMN/BSN\end{tabular} & Nein              & \begin{tabular}[c]{@{}l@{}}In Absprache mit den Fachcoaches, ist ein \\Hardwaremodul nicht notwendig.\end{tabular}                                          \\ 
		\hline
		P2            & Vergleich SoC                                                      & Bedingt           & \begin{tabular}[c]{@{}l@{}}Die Bluetooth Tests wären mit verschiedenen \\SoCs möglich, diese Messungen wurden aber \\nicht ausgeführt.\end{tabular}  \\ 
		\hline
		P3            & Drahtlos Konfiguration                                              & Nein              & \begin{tabular}[c]{@{}l@{}}Ein Firmware over the air upgrade wurde \\nicht umgesetzt.\end{tabular}                                                   \\ 
		\hline
		P4            & UI für Mesh Test                                                    & Nein              & \begin{tabular}[c]{@{}l@{}}Für die Mesh-Tests wurde aus zeitlichen \\Gründen kein User-Interface geschrieben\end{tabular}                       \\
		\hline
	\end{tabular}
	\caption{Erreichung der Zusatzziele}
	\label{tab:ErreichungZusatzziele}
\end{table}


\newpage
\subsection{Fazit}\label{subsec:Fazit}
In dieser Arbeit wurden die drei Mesh Protokolle Bluetooth Mesh, Thread und Zigbee unter verschiedenen Testszenarien ausgemessen und anschliessend miteinander verglichen.
Die wichtigste Erkenntnis ist, dass es kein bestes Mesh Netzwerk gibt.
Alle Protokolle haben ihre Stärken und Schwächen in verschiedenen Umgebungen und mit verschiedenen Messparametern.
Nachfolgend wird zusammengefasst, welche Schlüsse aus dem Vergleich der drei Protokolle gezogen worden sind.

\begin{itemize}

	\item Einer der grössten Vorteile von Bluetooth Mesh ist, die Interoperabilität. Der Mesh-Stack ist mit Milliarden von Geräten Weltweit kompatibel. 
	\item Ein Nachteil von Bleutooth Mesh ist das es über kein Routing verfügt. Das Managed Flooding Prinzip führt zu hohen Netzwerk Belastungen, wenn die Topologie eine sehr hohe Node-Dichte aufweist.
	\item Der grösste Vorteil von Thread ist, dass sich das Mesh-Netzwerk selber ausmisst. Die routenden Knoten werden automatisch bestimmt. Somit kann sich das Protokoll der Umgebung anpassen und konnte dadurch auch in allen Testumgebungen eine tiefe Latenz aufweisen.
	\item Ein Nachteil von Thread ist, dass aufgrund des automatischen Routen ein höherer Overhead entsteht. Durch diesen Overhead steigt der Energieverbrauch auf den einzelnen Nodes.
	\item Zigbee weist eine hohe Zuverlässigkeit auf.
	Bedingt durch das CSMA\slash CA des\linebreak \textit{IEEE 802.15.4} MAC und Physical Layers erreichen rund 98 Prozent der Nachrichten ihr Ziel mit konstant tiefer Latenzzeit.
	\item Der gemessene Durchsatz und die gemessene Latenzzeit von Zigbee, können nicht ganz mit jenen Werten von Thread mithalten.
	Daher ist die Performance bei hoher Belastung eher schlechter.
\end{itemize}

Nachfolgend wird auf einige Probleme eingegangen, welche während dem Projekt entstanden sind. Ausserdem werden mögliche Lösungen dafür vorgeschlagen.
Die Probleme werden in organisatorische und technische Verbesserungsvorschläge aufgeteilt.

\textbf{Organisatorische Verbesserungen}
\begin{itemize}
	\item Ein frühzeitig definiertes Softwarekonzept hätte sehr viel Redundanz in der verschiedenen Firmware Teilen erspart und somit hätte viel effizienter gearbeitet werden können.
	\item Der zu Beginn erstellte Zeitplan wurde nicht eingehalten, deswegen wurden die Arbeiten zum Teil unstrukturiert ausgeführt, was zu Zeitmangel führte. 
\end{itemize}

\textbf{Technische Verbesserungen}
\begin{itemize}
	\item Durchschnittswerte sollten mit dem Median bestimmt werden. Der verwendete Mittelwert wird zu sehr von Ausreissern in der Latenzzeit verfälscht. Daher ist die durchschnittliche Latenz meist nicht repräsentativ.
	\item Es wurden ungünstige Messparameter verwendet. Die Nachrichtendichte ist zu gross gewählt und muss heruntergesetzt werden, damit sich die Protokolle besser vergleichen lassen.
	\item Beim Reporting vom BSN zum BMN ist es möglich, dass sich die Daten von zwei Slaves überschneiden. Mit Hilfe der Node ID könnte dies verhindert werden, indem nur der BSN mit der entsprechender Node ID angesprochen wird.
	\item Beim Zigbee Protokoll ist es leider nicht möglich die Anzahl Hops auszulesen, die eine Nachricht bei der Übertragung passiert. Dies müsste für eine repräsentative Auswertung noch implementiert werden können, da die Latenzzeit pro Hop bestimmt wird.
	\item Die Message ID der Nodes werden in der Payload der Benchmark-Nachricht mitgegeben. Dadurch ist es nicht möglich eine Payload unter 2 Byte zu versenden. Besser wäre ein Auslesen der Message ID vom entsprechenden Header.
\end{itemize}

\newpage
\subsection{Ausblick}\label{subsec:Ausblick}
In diesem Abschnitt wird darauf eingegangen, welche Module zu den bereits bestehenden Modulen noch ergänzt werden könnten, um z.B. die Bedienung noch benutzerfreundlicher zu machen. Diese Informationen dienen als Hinweis, falls die Arbeit von einer anderen Person weitergeführt wird.

\begin{itemize}
	\item Damit die Bedienung benutzerfreundlicher wird, kann für die gesamte Mesh-Test Umgebung ein GUI erstellt werden. Mit Hilfe einem User Interface können alle Einstellungen und Auswertung direkt an einem Ort visualisiert werden. Durch dies würde eine mühsame Auswertung mit externen Programmen wie Excel entfallen.
	\item Ein Over-The-Air Firmware Upgrade würde die Bedienung zusätzlich vereinfachen. Mit Hilfe des GUIs kann das entsprechende Protokoll ausgewählt werden und die BSN werden mit der entsprechenden Firmware geladen. Das würde bedeuten, dass ein mühseliges Flashen der einzelnen Nodes entfällt.
	\item Damit die einzelnen BSN robuster werden und auch weitere Parameter wie z.B. der Stromverbrauch erfasst werden können, ist eine eigene Hardware Entwicklung sinnvoll. Dadurch könnte der Batteriestand von den einzelnen Nodes bestimmt werden und ein Warnung würde dem Benutzer mitteilen, dass die Batterien ausgetauscht werden müssen.
\end{itemize}

\subsection{Schlusswort}\label{subsec:Schlusswort}
Das Ziel dieser Bachelor-Thesis war die drei Mesh-Protokolle BT-Mesh, Thread und Zigbee miteinander zu vergleichen.
Dieses Ziel konnte erreicht werden.
Der Weg zu diesem Ziel war teilweise steinig und ungewiss.
Da das Softwarekonzept und die Arbeitsaufteilung besonders zu Beginn der Arbeit nur teilweise umgesetzt werden konnten, mussten viele Zeilen Code doppelt geschrieben werden.
Dank dem sehr grossen Durchhaltewillen aller Teammitglieder und dem starken Entschluss eine sehr gute Bachelor-Thesis zu liefern, konnten trotz diversen Rückschlägen aussagekräftige Resultate erzielt werden.
Durch das Einlesen und Einarbeiten in neue Themen wie Mesh-Netzwerke, Firmwareprogrammierung, Webserver, Funksysteme und Zeitsynchronisation konnten zahlreiche neue Erfahrungen gesammelt werden. Dank diesen Erfahrungen wurden die Kenntnisse der Programmiersprachen C, C\texttt{++}, Python, HTML und Java Script verbessert oder gar neu erlernt.
Dank der guten Teamarbeit konnte schliesslich ein Resultat erzielt werden, das aussagekräftig ist und ein Grossteil der gesetzten Ziele erfüllt. 

Zum Schluss möchten wir uns bei unseren Projektbetreuern Herrn M. Meier und Herrn M. Di Cerbo für die fachliche Unterstützung bedanken.
Sie haben uns bei unseren Ideen und unserem Vorgehen stets unterstützt und halfen uns fachlich weiter, wo es nötig war. Wir danken ihnen, dass wir unsere Visionen in dieser Bachelor-Thesis verwirklichen durften.